<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />

<meta name="viewport" content="width=device-width, initial-scale=1">



<title>R/lmmlite user guide</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>



<link href="data:text/css;charset=utf-8,body%20%7B%0Abackground%2Dcolor%3A%20%23fff%3B%0Amargin%3A%201em%20auto%3B%0Amax%2Dwidth%3A%20700px%3B%0Aoverflow%3A%20visible%3B%0Apadding%2Dleft%3A%202em%3B%0Apadding%2Dright%3A%202em%3B%0Afont%2Dfamily%3A%20%22Open%20Sans%22%2C%20%22Helvetica%20Neue%22%2C%20Helvetica%2C%20Arial%2C%20sans%2Dserif%3B%0Afont%2Dsize%3A%2014px%3B%0Aline%2Dheight%3A%201%2E35%3B%0A%7D%0A%23header%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0A%23TOC%20%7B%0Aclear%3A%20both%3B%0Amargin%3A%200%200%2010px%2010px%3B%0Apadding%3A%204px%3B%0Awidth%3A%20400px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Aborder%2Dradius%3A%205px%3B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Afont%2Dsize%3A%2013px%3B%0Aline%2Dheight%3A%201%2E3%3B%0A%7D%0A%23TOC%20%2Etoctitle%20%7B%0Afont%2Dweight%3A%20bold%3B%0Afont%2Dsize%3A%2015px%3B%0Amargin%2Dleft%3A%205px%3B%0A%7D%0A%23TOC%20ul%20%7B%0Apadding%2Dleft%3A%2040px%3B%0Amargin%2Dleft%3A%20%2D1%2E5em%3B%0Amargin%2Dtop%3A%205px%3B%0Amargin%2Dbottom%3A%205px%3B%0A%7D%0A%23TOC%20ul%20ul%20%7B%0Amargin%2Dleft%3A%20%2D2em%3B%0A%7D%0A%23TOC%20li%20%7B%0Aline%2Dheight%3A%2016px%3B%0A%7D%0Atable%20%7B%0Amargin%3A%201em%20auto%3B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dcolor%3A%20%23DDDDDD%3B%0Aborder%2Dstyle%3A%20outset%3B%0Aborder%2Dcollapse%3A%20collapse%3B%0A%7D%0Atable%20th%20%7B%0Aborder%2Dwidth%3A%202px%3B%0Apadding%3A%205px%3B%0Aborder%2Dstyle%3A%20inset%3B%0A%7D%0Atable%20td%20%7B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dstyle%3A%20inset%3B%0Aline%2Dheight%3A%2018px%3B%0Apadding%3A%205px%205px%3B%0A%7D%0Atable%2C%20table%20th%2C%20table%20td%20%7B%0Aborder%2Dleft%2Dstyle%3A%20none%3B%0Aborder%2Dright%2Dstyle%3A%20none%3B%0A%7D%0Atable%20thead%2C%20table%20tr%2Eeven%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Ap%20%7B%0Amargin%3A%200%2E5em%200%3B%0A%7D%0Ablockquote%20%7B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Apadding%3A%200%2E25em%200%2E75em%3B%0A%7D%0Ahr%20%7B%0Aborder%2Dstyle%3A%20solid%3B%0Aborder%3A%20none%3B%0Aborder%2Dtop%3A%201px%20solid%20%23777%3B%0Amargin%3A%2028px%200%3B%0A%7D%0Adl%20%7B%0Amargin%2Dleft%3A%200%3B%0A%7D%0Adl%20dd%20%7B%0Amargin%2Dbottom%3A%2013px%3B%0Amargin%2Dleft%3A%2013px%3B%0A%7D%0Adl%20dt%20%7B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0Aul%20%7B%0Amargin%2Dtop%3A%200%3B%0A%7D%0Aul%20li%20%7B%0Alist%2Dstyle%3A%20circle%20outside%3B%0A%7D%0Aul%20ul%20%7B%0Amargin%2Dbottom%3A%200%3B%0A%7D%0Apre%2C%20code%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0Aborder%2Dradius%3A%203px%3B%0Acolor%3A%20%23333%3B%0Awhite%2Dspace%3A%20pre%2Dwrap%3B%20%0A%7D%0Apre%20%7B%0Aborder%2Dradius%3A%203px%3B%0Amargin%3A%205px%200px%2010px%200px%3B%0Apadding%3A%2010px%3B%0A%7D%0Apre%3Anot%28%5Bclass%5D%29%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Acode%20%7B%0Afont%2Dfamily%3A%20Consolas%2C%20Monaco%2C%20%27Courier%20New%27%2C%20monospace%3B%0Afont%2Dsize%3A%2085%25%3B%0A%7D%0Ap%20%3E%20code%2C%20li%20%3E%20code%20%7B%0Apadding%3A%202px%200px%3B%0A%7D%0Adiv%2Efigure%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0Aimg%20%7B%0Abackground%2Dcolor%3A%20%23FFFFFF%3B%0Apadding%3A%202px%3B%0Aborder%3A%201px%20solid%20%23DDDDDD%3B%0Aborder%2Dradius%3A%203px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Amargin%3A%200%205px%3B%0A%7D%0Ah1%20%7B%0Amargin%2Dtop%3A%200%3B%0Afont%2Dsize%3A%2035px%3B%0Aline%2Dheight%3A%2040px%3B%0A%7D%0Ah2%20%7B%0Aborder%2Dbottom%3A%204px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Apadding%2Dbottom%3A%202px%3B%0Afont%2Dsize%3A%20145%25%3B%0A%7D%0Ah3%20%7B%0Aborder%2Dbottom%3A%202px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Afont%2Dsize%3A%20120%25%3B%0A%7D%0Ah4%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23f7f7f7%3B%0Amargin%2Dleft%3A%208px%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Ah5%2C%20h6%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23ccc%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Aa%20%7B%0Acolor%3A%20%230033dd%3B%0Atext%2Ddecoration%3A%20none%3B%0A%7D%0Aa%3Ahover%20%7B%0Acolor%3A%20%236666ff%3B%20%7D%0Aa%3Avisited%20%7B%0Acolor%3A%20%23800080%3B%20%7D%0Aa%3Avisited%3Ahover%20%7B%0Acolor%3A%20%23BB00BB%3B%20%7D%0Aa%5Bhref%5E%3D%22http%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0Aa%5Bhref%5E%3D%22https%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0A%0Acode%20%3E%20span%2Ekw%20%7B%20color%3A%20%23555%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Edt%20%7B%20color%3A%20%23902000%3B%20%7D%20%0Acode%20%3E%20span%2Edv%20%7B%20color%3A%20%2340a070%3B%20%7D%20%0Acode%20%3E%20span%2Ebn%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Efl%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Ech%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Est%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Eco%20%7B%20color%3A%20%23888888%3B%20font%2Dstyle%3A%20italic%3B%20%7D%20%0Acode%20%3E%20span%2Eot%20%7B%20color%3A%20%23007020%3B%20%7D%20%0Acode%20%3E%20span%2Eal%20%7B%20color%3A%20%23ff0000%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Efu%20%7B%20color%3A%20%23900%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%20code%20%3E%20span%2Eer%20%7B%20color%3A%20%23a61717%3B%20background%2Dcolor%3A%20%23e3d2d2%3B%20%7D%20%0A" rel="stylesheet" type="text/css" />

</head>

<body>




<h1 class="title toc-ignore">R/lmmlite user guide</h1>



<p><a href="http://kbroman.org/lmmlite">R/lmmlite</a> is an R package for fitting linear mixed models in the context of genome-wide association studies (GWAS) and quantitative trait locus (QTL) mapping. At present, <strong>it is not intended for “production” use.</strong> I wrote this to try to get a better understanding of how to fit these models, and I’ve not yet put any effort into checking arguments and omitting cases with missing values.</p>
<p>The code closely follows <a href="http://whatmind.com">Nick Furlotte</a>’s <a href="https://github.com/nickFurlotte/pylmm">pylmm</a>.</p>
<p>The sort of model I want to fit is <span class="math inline">\(y = X\beta + \epsilon\)</span> where <span class="math inline">\(\epsilon\)</span> is multivariate normal with mean 0 and variance <span class="math inline">\(\sigma^2_g K + \sigma^2_e I\)</span>, where <span class="math inline">\(K\)</span> is a known kinship matrix and <span class="math inline">\(I\)</span> is the identity. In pylmm, the focus is on <span class="math inline">\(\sigma^2 = \sigma^2_g + \sigma^2_e\)</span> and the heritability <span class="math inline">\(h^2 = \sigma^2_g / \sigma^2\)</span>.</p>
<p>We’ll focus here on the <code>recla</code> dataset that I include with the package. This is data on a set of diversity outcross mice, from <a href="https://www.ncbi.nlm.nih.gov/pubmed/24700285">Recla et al. (2014)</a> and <a href="https://www.ncbi.nlm.nih.gov/pubmed/23433259">Logan et al. (2013)</a>. The data are originally from the <a href="https://phenome.jax.org/projects/Recla1">QTL Archive/Mouse Phenotype Database</a> and I’ve also <a href="https://github.com/kbroman/qtl2data/tree/master/DO_Recla">placed them online</a> in the format used by <a href="https://kbroman.org/qtl2">R/qtl2</a>. I used <a href="https://github.com/rqtl/qtl2geno">qtl2geno</a> to calculate genotype probabilities from the MUGA SNP array data. The data include 261 mice, and form a list with three components: the estimated kinship matrix, a matrix with 26 phenotypes, and a covariate matrix that contains an intercept (all 1’s) and sex (0 for female and 1 for male).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(lmmlite)
<span class="kw">data</span>(recla)</code></pre></div>
<p>The package includes two implementations of the fit of linear mixed models (LMMs): plain R, and C++ (using the <a href="https://github.com/RcppCore/Rcpp">Rcpp</a> and <a href="https://github.com/RcppCore/RcppEigen">RcppEigen</a> packages, the latter being an interface to the <a href="http://eigen.tuxfamily.org/">Eigen</a> C++ linear algebra library).</p>
<p>R/lmmlite includes just four functions: <code>eigen_rotation()</code>, <code>getMLsoln()</code>, <code>calcLL()</code>, and <code>fitLMM()</code>. In each case, use <code>use_cpp=FALSE</code> to use the plain R implementation and <code>use_cpp=TRUE</code> (the default) to use the C++ implementation.</p>
<p>The first function, <code>eigen_rotation()</code>, calculates the eigen decomposition of the kinship matrix and “rotates” the phenotypes and covariates by pre-multiplying them with the tranpose of the matrix of eigenvectors. This rotation greatly simplifies later calculations by turning a general least squares problem into a weighted least squares problem.</p>
<p>Care must be taken with missing values in the phenotypes and covariates. In practice, one must work with batches of phenotypes that have a common missing data pattern, and first remove individuals with missing values. Here, we’ll focus on the first phenotype.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">e &lt;-<span class="st"> </span><span class="kw">eigen_rotation</span>(recla<span class="op">$</span>kinship, recla<span class="op">$</span>pheno[,<span class="dv">1</span>], recla<span class="op">$</span>covar)</code></pre></div>
<p>The output is a list containing four components: <code>Kva</code> is the vector of eigenvalues of the kinship matrix, <code>Kva_t</code> is the transposed matrix of eigenvectors, <code>y</code> is the rotated phenotype matrix, and <code>X</code> is the rotated covariate matrix.</p>
<p>The next function <code>getMLsoln()</code> will estimates the coefficients (<span class="math inline">\(\beta\)</span>) and residual variance (<span class="math inline">\(\sigma^2 = \sigma^2_g + \sigma^2_e\)</span>) for a given value of the heritability (<span class="math inline">\(h^2 = \sigma^2_g / \sigma^2\)</span>). It takes, as input, a single value for the heritability, and then <code>Kva</code>, <code>y</code>, and <code>X</code>, as returned from <code>eigen_rotation()</code>. A further argument <code>reml</code>, indicates whether REML will later be used, in which case the log determinant of the matrix <span class="math inline">\(X' W X\)</span>, where <span class="math inline">\(W\)</span> is a diagonal matrix of weights, is calculated.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">ml_soln &lt;-<span class="st"> </span><span class="kw">getMLsoln</span>(<span class="fl">0.5</span>, e<span class="op">$</span>Kva, e<span class="op">$</span>y, e<span class="op">$</span>X)</code></pre></div>
<p>The result is a list containing <code>beta</code> and <code>sigmasq</code>, with the residual sum of squares (RSS) and log det(<span class="math inline">\(X' W X\)</span>) included as attributes.</p>
<p>The function <code>calcLL()</code> calculates the log likelihood for a given value of the heritability. (It can also take a vector of heritabilities.) It takes the same arguments as <code>getMLsoln()</code>, and in practice one would probably not call <code>getMLsoln()</code> directly.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">hsq &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dt">by=</span><span class="fl">0.01</span>)
ll &lt;-<span class="st"> </span><span class="kw">calcLL</span>(hsq, e<span class="op">$</span>Kva, e<span class="op">$</span>y, e<span class="op">$</span>X)</code></pre></div>
<p>We can plot the results as follows.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(hsq, ll, <span class="dt">type=</span><span class="st">&quot;l&quot;</span>, <span class="dt">lwd=</span><span class="dv">2</span>, <span class="dt">las=</span><span class="dv">1</span>,
     <span class="dt">xlab=</span><span class="st">&quot;heritability&quot;</span>, <span class="dt">ylab=</span><span class="st">&quot;log likelihood&quot;</span>)</code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAqAAAAGACAMAAABFpiBcAAADAFBMVEUAAAABAQECAgIDAwMEBAQFBQUGBgYHBwcICAgJCQkKCgoLCwsMDAwNDQ0ODg4PDw8QEBARERESEhITExMUFBQVFRUWFhYXFxcYGBgZGRkaGhobGxscHBwdHR0eHh4fHx8gICAhISEiIiIjIyMkJCQlJSUmJiYnJycoKCgpKSkqKiorKyssLCwtLS0uLi4vLy8wMDAxMTEyMjIzMzM0NDQ1NTU2NjY3Nzc4ODg5OTk6Ojo7Ozs8PDw9PT0+Pj4/Pz9AQEBBQUFCQkJDQ0NERERFRUVGRkZHR0dISEhJSUlKSkpLS0tMTExNTU1OTk5PT09QUFBRUVFSUlJTU1NUVFRVVVVWVlZXV1dYWFhZWVlaWlpbW1tcXFxdXV1eXl5fX19gYGBhYWFiYmJjY2NkZGRlZWVmZmZnZ2doaGhpaWlqampra2tsbGxtbW1ubm5vb29wcHBxcXFycnJzc3N0dHR1dXV2dnZ3d3d4eHh5eXl6enp7e3t8fHx9fX1+fn5/f3+AgICBgYGCgoKDg4OEhISFhYWGhoaHh4eIiIiJiYmKioqLi4uMjIyNjY2Ojo6Pj4+QkJCRkZGSkpKTk5OUlJSVlZWWlpaXl5eYmJiZmZmampqbm5ucnJydnZ2enp6fn5+goKChoaGioqKjo6OkpKSlpaWmpqanp6eoqKipqamqqqqrq6usrKytra2urq6vr6+wsLCxsbGysrKzs7O0tLS1tbW2tra3t7e4uLi5ubm6urq7u7u8vLy9vb2+vr6/v7/AwMDBwcHCwsLDw8PExMTFxcXGxsbHx8fIyMjJycnKysrLy8vMzMzNzc3Ozs7Pz8/Q0NDR0dHS0tLT09PU1NTV1dXW1tbX19fY2NjZ2dna2trb29vc3Nzd3d3e3t7f39/g4ODh4eHi4uLj4+Pk5OTl5eXm5ubn5+fo6Ojp6enq6urr6+vs7Ozt7e3u7u7v7+/w8PDx8fHy8vLz8/P09PT19fX29vb39/f4+Pj5+fn6+vr7+/v8/Pz9/f3+/v7////isF19AAAACXBIWXMAAA7DAAAOwwHHb6hkAAAbCElEQVR4nO2deXzUdPrHn+m0paUUKC1XKSxUxHKJyG0RBQ9YEZFbLhHkWjkWBCkrIuVYtiBgEcRWEJZDF1g5itzlp0UrLoL+EFlAAQHxACwgV6H0yCbTdmid9MjkejLzef+RSabJ93nmNe9Okm+S50sCAIwhsxMAoDggKGANBAWsgaCANRAUsAaCAtZAUMAaCApYA0EBayAoYA0EBayBoIA1EBSwBoIC1kBQwBoIClgDQQFrIChgDQQFrIGggDUQFLAGggLWQFDAGggKWANBAWsgKGANBAWsgaCANRAUsAaCAtZAUMAaCApYA0EBayAoYA0EBayBoIA1EBSwBoIC1kBQwBoIClgDQQFrIChgDQQFrIGggDUQFLAGggLWQFDAGggKWANBAWsgKGANBAWsgaCANRAUsAaCAtZAUMAaCApYA0EBayAoYA0EBayBoIA1EBSwBoIC1kBQwBoIClgDQQFrIChgDQQFrIGggDUQFLAGggLWQFDAGggKWANBAWsgKGANBAWsgaCANRAUsEZjQV9uBkApaHveHEFbrzgIQMnc+41Jgn6hbXvAQ7kfggLOQFDAGggKWANBAWsgqPdy+9KpYwdTkv+9fnniwri4GTExMROG32WiuBwbFzc/cdn6D5NTDh774fItM5LUQNCMv0eVbTD3jiBcHV07qOm/BLkZFyCo8WRf+O9nSSvmT3mpf+e2jeqE+JFSfEMi74/u3H/UlPkrklKPns82ImkNBJ0cMHtnbJmxgtCr6rs7h9I2uRkXIKhBZP68P+ndGaN7PFy/su0PvvmF1Lmv2cOP9+j1wvAxMTFT4+Li3ki8y1xx+fWYmPHDh/Tq/ni7ZvVqh/j/YXtb5Qbteo6eseyjL3/O0i1/9YJmB74qTmf43bpE/xRnGg0QXGdcgaD6knn60zVzxjzTrLpPQaHqR3cZNH7molVb9h46dSlDcaMZl04d+nTLqrdmvDyoS3RUlQLC28NbPDNm7gepP2Zq/UHUC3ouKlWcrqazp184I848+rzgOuMKBNWH7HN7V0wd+HAtX6eV1Zo+PeS1hev2/veC1rvk7PNHUtYufPWFzk2rOV31rf3oC7ErU3/VLIhGJ0np7epKH/9C6ozgTwTZGQcZzitYDT93I1lQNNmnk5e83CWqTJ4oPhHRz01cuPGLn+4YEv3OuX0b4l/u3SY8/we7bONuk5bu1cBTbQT9unnwPuk1LrDy8zflZxykOu8BsM93L1/gQvrXH0zt3SQgz4xqbfpPXfHxKeX7b23I+H730inPtQzNy6Z8i4GzNxxTs99XJegeMYXJgnBpsE+3M3lv5fTtWtRMIcotVZYnkCHj0JqYLvfk/WiFPzpszsbDN0veyhB+/2rdrEFtwnJT82/cZ+aGE+4dYagS9Obx48cvCt+HN/pSWto+UJouo2zXGddNIag6ft4+u0/D3I4iv/o9pqw+cNXsjGRJ+2zpxM6Ruf9CQS2HLtz7u9IW1O/icxp2yu3BTaavxenIcJkZVyCou+ScWDfpicq55871esauP2LW3rz03Dy4MuapmrnnbJE9Zm2/qGBb9YKm0vhlEul3mtRdtWuSfbHgOuMKBHWHH9ZOaF/B8UWHPDpuxcF0s/NRxOWUxcOa5x4q1+o2a9eV0m2lXtDEvOPh88K5fuFBD64S33KdcQGCKuTy9ml/zj2kC+8yLelMyRvwJPPwqvHtgh2/pfcNXLS/5D4Gs67FQ9DSk/1twqAoR09jlc6xW7XrYjSN7GNrxkcHSh8osO0rm4p/pgOC8ubmJzOfqpj7VU74t2V/N+XI/DphcH3Hv129wcu/K3I1CMqXq9smP+S4/l27/6IDxnS4G83lbVMfKyd9xKq9Fn+bI7cGBOXJtW2vtLBLJ+oP/nXdz2Ynoy+ZB+N7VpMkDXtepkMCgvLj1v+92lq6lu4fPXkbz+5N7Tn+bv8Isp91/QME5UXOV3FPSKcPvg+9mszlqpBRnDws8yYEZcSvq/pXkTpgmkzYft3sXLgAQZmQ9dmrTaVz2lpD1yq50OLxQFAO/LaqT4h0j9pT8cfMToUbENR0jsRFS+fr9cbtum12KgyBoKaStXd8pChnmY6LTpqdClMgqHmkbx4sXV2vOmQjTomKBIKaxLW1vYJEO++L2WfI07uWBYKawdXVzwQQ2VrE4ZyoJCCo4Vx7v6top8/Db8pcNwF/BIIay60NPSU7H3nbA+6aMwQIaiBZOwdVkH47F/1idibWAYIaxsFx0j07zef/ZHYilgKCGsOZWfVFO6Omf292IlYDghrAjZUdfIiq/vVLsxOxIPqWXxTJjJarHeZFguZ8OjiYKLDfds3rankF+pZfFJlIXi3oL3H1xF179LuKCxaAXHQtvyiSFPIn7xU0K6mLL1GNKTjwdB9dyy8KwumQTa29VdCzU2sQ+Xffpl9xV29A3/KLGc3HCwUF/cVZv7fM226laxmyNj8lnhfdN++C2YlYHX3LL45qdaeQoMecJfr94t1M2BL8OrMmUZl+KbIP0gIl6Fp+cUOls4Lgfbv4vX38ierNTzM7D49A1/KL4/LKNm123dRjBU1f2oTIt9tu/Hhqg67lF7/bI1L/sT0yT4F5qKBnJoUSVXv9nNl5eA66ll904EW7+M962Ilav8+/YKeF0Lf8ooS3CHrn/eZE/gNxOVNbcC1eG67E1SCqPBV3eWoNBNWCM+OCiRovM2UwSw8Hgqrn676+RE/swnm7HkBQtXzckchv4CGz0/BUIKgqsje2IgqegG4l3YCgKshcVZ+oyszLZufhyUBQt8lIjCSqvdhaY8FYDgjqJrfeiiCqt8IzS8czQqGgYXfprCquxQVNXxhOdP9aVK3RHYWCJiQkxJerPfHNmLo1U1XFtbSg6fHViR7cjH4lA1C+ix/ZQdqtZXUaoSquhQW9/ZaoZ/Mt0NMQlAta40PHy2a5IWJLj2UFvZNQU9TzI+hpEMoFDV/oeHmrlqq4FhU0a0UdoibYuRuHckFfrCA9T7ytohfu4nM+rE/UYD30NBDlgl5rR5UaVaJH1VUFtqKgu5sT3bMaZ+6G4k4/6J64cW+kqIxrPUG/7EAUvgT9ngbjVkd9xlnVN5ZZTdCTfWxUaY63jf3GADcE3dTEh2yNNqqLay1BL47xp8DJV8xOwxtRLuhm6rIqeU1X2qIqrpUETZ9dnuxDcMeSKSgXtMVQx8uwVqriWkfQnDW1iDp/a3Ya3opyQcvlVq3bGZz/RjHlFzc4HqcbKtOcZQTdK566P7DH7Cy8F+WCRs1xvMxrkP9GMeUX51RNEJE747eIoD/0JKqxAj1L5qFc0OkBiy/kXFwSOD1vubjyi8OeLKo5Swh6/W8BFDQdp+5molzQrJF28iH7iPyqgsWVX2w/+vLX8ue+FhA0Z0V1sg3EkAfm4k4/6NktCUl/GISqiPKLNaP8ibr/5lztm175+C5QlbYBHGhF1Po/Zmfh9WjTUV9E+cXbgR2PXUsK7epcL219PgHvqEpbdy4O86Eaq3HV3XRUddSXVH4xl3iSKdDOexefuSiE/CdjDGIGqOqoL6n8Yu4GO+iEa3OsBf28CdGfvzM7CyChvqO+mPKLewKkDsSpFWS6aRgL+tsQG9VRd50MaIb6jvpiyi9mN4uYu2OK/xKZ5tgKmrOyMvmNxd6dC+o76osrv3h+cPVyLdfLNcdV0MNtiJ7A3p0P6jvq3YOnoDdj/KjGOrOzAAVQ31HvHiwF/bge+Qy/anYWoCAaddQrhqGgF54jegAFkpmB0jf5rAylcvMx4Cs3lAt6aewjbR2oistN0NMdiTqdKXk9YDDKBe1epv84B6ri8hI0a0EQha02Owsgg3JBy8/TIi4rQY+1IeovM5gTMB/lgtbZq0VcRoJmzQmgGlvNzgLIo1zQ1wZqEZePoEdakm2IzO0sgAUKBY2Pj19Qremrb4qv6oYr5iJoVlwZqrXT7CxAkSgUNKIAquIyEfS7NmRD1zxnvLofNCcxiKrhviXWeLOgZ9sTPY9yIbxRKugLi+PzURWXgaCrK1BVmZHsASuUCko9PeQY9FJvom7o+2SPUkFvaDRgqtmCJkdQcKK5KYDS4J3HoLfH2yj6lJkZgFKifBgaJ6rimiro0QfIb7a6+1mBQbg/kFeYqrhmCroyiGp/bl54oATv28WnPUs0GA/FWQW3BL19suBfiim/KBzoFFJnrlxzpgn6aU2qiKeOrIMbgr5T00ZC77s33RVTfvFAuX4bXrHJ9ZiaJGj2DF+KVvu4CjAQ5YIutw1fS8Kb9vziSsWVX+zWUZyZ0F2mOXMEvdCRbGMxUIeVUC5ogzFCmrjweqO85WLKL161ry2qOVME3VWFqiWbEBe4j3JBy253CLqrbMG/ypdf/JbWd6pYd1qGc7WUyHx85qjPXSFZU33oyfOGhwWqUC5o09cdgs5tXOCPRZRf3EWhsdtmB73kXC/7h1N5BBn+C/pre7L/HcW8rYZyQd/zm/EFnUssN7/k8ospJJ1K/cNHpoi24bv4lOpUZbfBMYF63DiLj68kelkmJqfk8osnSBo/YScdd23OYEFzZtnpMezeLYg7/aA39q/7+O59QMWUX8yqNVOcmRYgc95srKBXniafabi2aUWUC5pXjfbbDnnLxZRfFBb7x+6M9Z8l05yhgh66h0J3GBgPaIdyQasdFieXRttr5S0XV35RSGga1DhBrtK7kYKuLktNfzAuHNAS5YL2CdmX9XalsrHpquIaJ2jGSKJhGt3FCgxHuaDZw4MaUp8fVcY1TNBfoilguUGxgPa4c5I0mWTv/1CEUYIerEUR+40JBfRAoaApDp4pu0qcqoprkKArA+hh9C5ZGYWCUgFUxTVE0Dvi4edYlPy0NAoFTSuAqrhGCHqxHQWu0j8M0BMPvqP+cB0Kx+Gn1fHcwg1by1PrX/QOAvTGUws35Ey30aDb+sYABuChhRtuPUd2TSpBA5PxzGPQ862p/HY9AwCj8MjCDYdrU8TXOrYPjMMTCzd8FEwPXdCveWAkHriLX2Sn/rg5xFPwOEGzx5NthtwNfsCSeJqgt/qQP0bk8iA8TNC0aAr5RJeWgTl4lqDHI6nOMT0aBmbhUYLuC6NWOH33LJQL+kAuzZ8edTD3jaKr2+3JuzFPZqgCPQRNKktdZB7BB1ZGuaALylToObp36D1z+tjfc7xRdHW7nxwd+kPKn3ZtTgdB3/Olwbj509NQLuioaKn6683284WlVaXl4qrbSVyLlKsgprmgOVPINkPjNoH5KBe0xkbHy0f3Cb+TNApWMdXtHLwgO/is1oJmDiFfPBvngSgXtGbu6C3LqgknyVlJW766ncT+oJ/uNpJ9SqfiYbe6UhDuDvFElAv619BtOYKwo/KI6yPyS4QWVd1Oou2UAo3s1an84vXHKSRVywYBF5QLmtGLytYJos43NwcvKKG6nUiKr/xDlZru4s83peql/RzAWrjTD3o48bXF+wXh8rWSqtuJ015y9b8FbQU9GUlRqDvvobjVUZ9xtsDdQsVUtxOE33w3yjenoaBHqlOL3zRrDfDCDUE3NfEhWyOneMVVtxNW2y7JN6edoF+GUgcMe+SxKBd0M3VZlbymK23JWy62ul3fxnJtCRoKurc8Pa2ujhngjHJBWwx1vAxrpSquVoJuDaS+GFfGg1EuaLltjpedwariaiToWj/6CwZG8GSUCxqV24M5r4GquNoI+k+71M0FPBjlgk4PWHwh5+KSwOmq4moi6Ls+FKtBM4AxygXNGmknH7KPUDcmgRaCLrHZ5qtvBbDGnX7Qs1sSktR2jGsg6ByyLVTdCGCOde+ojyWf97TIBLDGspVFppLvGpVNAAtg1coir5MdfnoDFt3FTyX7+xplAlhjTUFfI/sHWmUCWGNJQSeR3wbNMgGssaKgU8h/k3aZANZYUNBpZJd7ThR4JNYTdB6OP70Jywm6gOyoXudFWE3QN8lnpbaZANZYTNBEm22ZtokA3lhL0NU+tre1zQMwx1KCbvKlOG3TANzRQNCiyy8KmbPvzZ1xwR1Bd5ehacq3ApZGA0GLLr8oxATM2TparjyoO4KmBtFYxRsBi6Ne0OLKL1adIM489KzMVsoF/TKYRmD0Dq9DvaDFlV8MlyqHdeghs5ViQY+G0QA8v+l9aHSSVET5xfnll++fXjbZuVra+nwC3lGW57k/0dN4/t0L0UbQosovprckopF31zvcu1cevgsUpXkxitrcULQF8AxUCbqnhPKLGQ2ePJqeWq+3zKbKdvFXH6T7LyvZAHgKqgQtqfziRyQ9/PkhnXTdVJGgt9pRPQwv452o38UXU35xJ30lzrxju+K6lRJBs7pRxJmSVwOeiHpBiym/eLtZ5HvJc8q/KLOVEkFHU+jR0q8NPAr1ghZXfjFtTGRgwzcyZLZSIOjrFPhZqVcGHgb/a/GJZC+iSjPwAtgLmuSLG+y8Ge6CfhZAs7SNDCwFc0GPh9IobQMDa8Fb0N/upafVlXkEFoe1oOmtqTkucHo3nAXNepYi5cepA14DZ0FHU+hxbaMCy8FY0LkU+Lm2QYH14CvoRh+fD7WNCSwIW0G/CsITnICvoD9H0GBtIwJLwlTQ602ondw9JsDb4Clo9jMUhTvogcBV0HEUJnMXPvBCWAq6jMrgDlDggKOgqWXoXW2jAcvCUNAzVWiitsGAdeEn6PX7qSPuYAJ5sBM0uytFyTwFCrwUfcsv3nqtXvmH98htVKSgf6NQnMADJ/qWX+wRtnjbi757ZTYqStB1Nr+PS5kR8AZ0Lb94yFEatOtTMlsVIeg3QbSolAkBr0DX8otrSCpYsyBQZit5QS/dQwNLmQ/wDnQtv/gpSZUX+5HzquXR4fn4xcu0ktWJHkwvZT7AO9C1/GJWy5rLd4wKpF/y1/s1MZ/wXTLNjKeq50qbOPAOdC2/KPw2OLzywHl2mcrIrb9wfe998k8tZTbAW9C1/GLuWjGRMpvKCfo4JZYyGeA16Fp+Mb3VckG4XWuazFZygp7aWspcgPega/lFoW/I/A3tI36V2UpOUABc0Lf84vW/VK3WU/a8B4KCUmHWtXgICkoFBAWsgaCANaYJOjnRhb93HGAE7fsbEaVrVyOi9G9vRJQBHXsbEaV3f1cnEmuYJOjS4a48Wq6+Efjea0SUsDAjotzra0SU+uVqGhGlZpiMFGOvmiOoHFu66B9DJPxnI6JMm2ZElJ/DjYgidNliRBR13z8EVQYEVQwEzQWCKgaCOoCgioGgTiCoMiCoYiBoLhBUMRDUAQRVDAR1AkGVAUEVw17QHd30jyFSy5Ch52cZMkDehVpGRBG67TAiirrv3wBBs4ypKJJmSJR0Y57+M+bDXDGkFpG6798AQQFwHwgKWANBAWsgKGANBAWsgaCANRAUsAaCAtZAUMAaCApYA0EBayAoYA0EBazRUdAVzSo8kiq7oFsY59A5ukYRyYweoEOQwlEOdAqpM1ePKIXCZM6+N3dsIR0Yd3doQbe/f/0EXUMvb+wWeEhmQb8wzqFzdI0iMpH0ELRQlAPl+m14xSZX81/TMDEBc7aOdgzbojU5O4Kcgrr//esn6P19BSErapjMgm5hnEPn6BpFJCnkT3oIWihKt47iZEJ3vcNUnSBOHnpW+yibgunu4Kzuf/+6CfojbRCnk6u7LugXxjl0jq5RBOF0yKbWOghaKMpV+1rtI7iGEcKniJMOPbQPc+XIkZr5gqr4/nUT9D90UJwm+GS5LOgXxkHe0Dk6RsloPl7QQ9BCUb6l9Z0q1p2WoXMYYX755funl03WPoxI3XxBVXz/ugm6nU6I03/RRZcF/cJI5A+do2OUUa3u6CJooSi7KDR22+ygl3QOI6S3JKKR2keRcAqq4vvX8RdUGnIh0eeOy4J+YQoPnaNXlA2VxEMIfX5BC0RJoXni9B8+N/UNk9HgyaPpqfV6ax5FosAvqNvfv47HoEni9LVqrgv6hXEOnaNrlHF51fs1P/MtFOUEpYjTnXRc6yiFw3zkOGD/kHQZirru3WNQt79//c7iGw0VhJwmQ2QWdAvjHDpH1yjf7RGp/9ge7Y9XCkbJqjVTnE4L0KFTt2CYnfSVOH3HpsuTt05BVXz/+gm62mf+vuGB34i/7M/dvrugaxjn0Dm6RnG8occuvnCUxf6xO2P99XgMv2CY280i30ueU/5FHcLkC6ru+9fxStI/m5ZvJ52vDKUbdxd0DXN36Bw9oziWdRG0cJSEpkGNE3L0DpM2JjKw4Rs6dBYI+YKq+/5xLR6wBoIC1kBQwBoIClgDQQFrIChgDQQFrIGggDUQFLAGggLWQFDAGggKWANBAWsgKGANBAWsgaCANRAUsAaCAtZAUMAaCApYA0EBayAoYA0EBayBoIA1EBSwBoIC1kBQlUSUror8SSpYoD0sQZ9kPBAIqhJ5QW/QC4IwoEDld6egjr+IgrqsAWSBoCqRFfT41Z6LixD0lvQXUdBbf1wDyAJBVRKxYGpkhZ6XBGkooKBGK6R3PniMzojetiai368ODy8TOVMSNLl7aL3YrFyjpV183hp/qSlucruCPgMieQAQVCUR1QakvCENzbTQ77Vto23viO9E/XnlLVG/Sz06nc8ZVGXulgm2taKgYWOTXraNLySotMaX0vgCm20/mv05uAJBVRLxgDjp94hwo9IMcWa4+HsY0UzI1VDagXdbJS40mSQK2k+cmVQmraCgjjVqTRGEvu1M/QycgaAqiZDGDhvXVthP+9LS0tbabgsR0shD+fqJnFvpP1EUVCppf4Q+cxF0XEPhZlCimR+BNRBUJRFvCg5B1+VVdz4hHpUKd/X7/46VK3asKgn6H/HdK7TBRdBP6fv1fpdM/hR8gaAqcZzFi4J+TD8VfCdPv98Dn/siR2gpCbpJkEbnOuAiaHbVud27mJc/dyCoSvIFvegv7abjexcWNFnS9noFSVBpKKJXKt5wEVQY0SRAr1EPPQAIqpJ8QYVJwfN2x/q+UUDQwQ0PnrC/tG9rm3LRx09S9Ze2TrLNKXQWL62RJeymctqP1uUxQFCVOAXNmdewbP0lQgFBP6kTfHV13aDWmz5pHv9T26NPVWy4UCgsqLSGcCd4oLkfgTUQ1HRO23aYnQJjIKjJZF0fFpFpdhKMgaAmc5J8tpqdA2cgqMlkpugwLp4HAUEBayAoYA0EBayBoIA1EBSwBoIC1kBQwBoIClgDQQFrIChgDQQFrIGggDUQFLAGggLWQFDAGggKWANBAWsgKGANBAWsgaCANRAUsOZ/SBFth1BhjO0AAAAASUVORK5CYII=" /><!-- --></p>
<p>If you call <code>calcLL()</code> with a single heritability value, the results include the estimates of <code>beta</code> and <code>sigmasq</code> as attributes.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">one_ll &lt;-<span class="st"> </span><span class="kw">calcLL</span>(<span class="fl">0.5</span>, e<span class="op">$</span>Kva, e<span class="op">$</span>y, e<span class="op">$</span>X)
<span class="kw">attr</span>(one_ll, <span class="st">&quot;beta&quot;</span>)</code></pre></div>
<pre><code>## [1] 1413.98691  -28.17931</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">attr</span>(one_ll, <span class="st">&quot;sigmasq&quot;</span>)</code></pre></div>
<pre><code>## [1] 276158.5</code></pre>
<p>The final function, <code>fitLMM()</code>, optimizes the log likelihood to estimate the heritability. The result is a list containing <code>beta</code>, <code>sigmasq</code>, <code>hsq</code>, <code>sigmasq_g</code>, <code>sigmasq_e</code>, and <code>loglik</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">(out &lt;-<span class="st"> </span><span class="kw">fitLMM</span>(e<span class="op">$</span>Kva, e<span class="op">$</span>y, e<span class="op">$</span>X))</code></pre></div>
<pre><code>## $beta
## [1] 1417.98330  -23.24218
## 
## $sigmasq
## [1] 295340.5
## 
## $hsq
## [1] 0.7642841
## 
## $sigmasq_g
## [1] 225724.1
## 
## $sigmasq_e
## [1] 69616.46
## 
## $loglik
## [1] -2332.84</code></pre>
<p>The <code>fitLMM()</code> function includes an argument <code>check_boundary</code>; if <code>TRUE</code> (the default), the 0 and 1 boundaries are checked explicitly, in seeking to estimate the heritability.</p>



<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
